<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><link rel="stylesheet" href="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /><title>Function details for cpmc</title><link rel="stylesheet" href="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">cpmc (1 call, 140.271 sec)</span><br/><i>Generated 14-Apr-2014 13:17:27 using cpu time.</i><br/>function in file /home/mihai/Downloads/cpmc_release1/code/cpmc.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file7.html">cpmc_example</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line117">117</a></td><td class="td-linebottomrt"><pre>masks = cpmc_masks(exp_dir, im...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">96.198 s</td><td class="td-linebottomrt" class="td-linebottomrt">68.6%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=69 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line132">132</a></td><td class="td-linebottomrt"><pre>D = get_features(exp_dir, img_...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">25.821 s</td><td class="td-linebottomrt" class="td-linebottomrt">18.4%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=18 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line161">161</a></td><td class="td-linebottomrt"><pre>overlap_mat = single(segm_over...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">14.299 s</td><td class="td-linebottomrt" class="td-linebottomrt">10.2%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=10 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line156">156</a></td><td class="td-linebottomrt"><pre>[Feats] = SvmSegm_mix_linear_a...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.811 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.3%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line159">159</a></td><td class="td-linebottomrt"><pre>small_masks = imresize(masks, ...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.104 s</td><td class="td-linebottomrt" class="td-linebottomrt">0.8%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">1.039 s</td><td class="td-linebottomrt">0.7%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">140.271 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file49.html">cpmc_masks</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">96.190 s</td><td class="td-linebottomrt">68.6%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=69 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file170.html">cpmc>get_features</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">25.821 s</td><td class="td-linebottomrt">18.4%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=18 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file266.html">segm_overlap_mex</a></td><td class="td-linebottomrt">MEX-file</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">14.299 s</td><td class="td-linebottomrt">10.2%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=10 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file52.html">SvmSegm_mix_linear_and_random_features</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.804 s</td><td class="td-linebottomrt">1.3%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file100.html">imresize</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">1.104 s</td><td class="td-linebottomrt">0.8%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file302.html">diversify_ranking</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.505 s</td><td class="td-linebottomrt">0.4%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file298.html">scale_data</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">6</td><td class="td-linebottomrt">0.137 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file301.html">predict_regressor</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.022 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file198.html">cell2mat</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.014 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file300.html">cpmc>@(a)size(a,1)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">6</td><td class="td-linebottomrt">0.007 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file53.html">DefaultVal</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.007 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file299.html">cpmc>create@(a)size(a,1)</a></td><td class="td-linebottomrt">anonymous function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.361 s</td><td class="td-linebottomrt">0.3%</td><td class="td-linebottomrt"><img src="file:////home/mihai/MATLAB/R2013a/toolbox/matlab/codetools/private/one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">140.271 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line144">144</a></td><td class="td-linebottomrt"><span class="mono">Variable 'scaling' is used, but might be unset.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">126</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">73</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">53</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">49</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">4</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">92.45 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [masks, scores] = cpmc(exp_dir, img_name, diversify_const, segm_pars)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  43</span> <span style="color: #000000; background: #FFFFFF;">    <a href="file53.html">DefaultVal</a>('*diversify_const', '0.75'); </span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">    %  do switch to '''attention_model_fewfeats_lambda_10.00_trainval.mat'''</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">    %  for imgs not in the VOC2010 trainval image set.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  47</span> <span style="color: #000000; background: #FFFFFF;">    <a href="file53.html">DefaultVal</a>('*ranker_file', '''attention_model_fewfeats_lambda_10.00_train.mat''');  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  48</span> <span style="color: #000000; background: #FFFFFF;">    <a href="file53.html">DefaultVal</a>('*segm_pars', '[]'); </span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  50</span> <span style="color: #000000; background: #FFFFFF;">    if(isempty(segm_pars)) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  51</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.pb_folder = [exp_dir './PB/']; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  52</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.name = 'dummy_masks'; </span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">        % UniformSegmenter uses a uniform unary term. LongRangeSegmenter</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">        % uses a color-based unary term. GridOfFramesSegmenter is defined</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">        % inside subframes (rectangular regions of interest), and it's good for smaller objects.       </span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">        % Each will generate and solve different energy functions.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  58</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.segm_methods = {'UniformSegmenter', 'LongRangeSegmenter', 'GridOfFramesSegmenter'};         </span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">        % can set a limit on the number of segments for each kind of</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">        % Segmenter. The joint set will be filtered in the end.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  62</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.max_n_segms = [inf inf inf];  </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  63</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.min_n_pixels = 200; % 1000 </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  64</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.sigma = {1, 2, 0.8}; </span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;">        %segm_pars.sigma = {1.2, 2.2, 1}; % larger is smoother (fewer segments)</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">        % how much to resize the image (there doesn't seem to be any numerical negative </span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">        % impact on the VOC segmentation dataset to resize to half).</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  69</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.resize_factor= 0.5; </span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">        % does a morphological operation to remove little wires in the</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">        % image. In general a good idea. But might negatively affect wiry structures</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">        % like bikes a little bit.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  74</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.morph_open = true; </span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;">        % Do the fast filtering step (always recommended).</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  77</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.filter_segments = {true, true, true}; </span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">        % Dimensions of the grid, for each segmenter type.</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">        %</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;">        % Be careful with the third set. In GridOfFramesSegmenter, a grid</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">        % is set up inside each subframe . [1 1] sets a single</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;">        % foreground seed, [2 2] would set 4 foreground seeds. If you have 40 subframes like currently, it's</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #228B22; background: #FFFFFF;">        % really better not to have more than [1 1].</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF;">        % On the other two [5 5] should be fine. We used [6 6] on</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;">        % the VOC2010 challenge.</span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  87</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.grid_dims = {[5 5], [5 5], [1 1]};   </span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF;">        % The maximum energy for the initial filtering step, for each</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;">        % method. The proper value depends on the sigma value, which is</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF;">        % unfortunate. If  you don't to spend time on it, just leave the</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #228B22; background: #FFFFFF;">        % default value. If you don't want to filter based on the energy uncomment the following line        </span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;">        %the_segm_pars.max_energy = {inf, inf, inf};        </span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;">        %%%% these are parameters related to the GridOfFramesSegmenter</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #228B22; background: #FFFFFF;">        % Two options are implemented: a regular grid of subframes, and</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;">        % using a bounding box detector. Using the detector gets 1% better</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;">        % covering.        </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.window_gen_parms.kind = 'grid_sampler';         </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.windows_folder = [exp_dir 'WindowsOfInterest/grid_sampler'];                 </span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">        % If you want to use instead the detector you'll have to install</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;">        % the latent svm code from http://people.cs.uchicago.edu/~pff/latent/, including the star</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">        % cascade. Then you can uncomment the  two bottom lines</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;">        %segm_pars.window_gen_parms.kind = 'sliding_window_detection';</span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #228B22; background: #FFFFFF;">        %segm_pars.windows_folder = [exp_dir 'WindowsOfInterest/sliding_window_detection']; </span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.window_gen_parms.det_classes = []; % this needs to be here (bug) </span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">        segm_pars.randomize_N = 1000; % maximum number of segments to pass to the clustering step, for each type of segmenter. For speed considerations. </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 110</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%% 1. compute masks %%%%%%%%%%%%    </span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 115</span> <span style="color: #000000; background: #FFFFFF;">    t = tic(); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 116</span> <span style="color: #000000; background: #FFFFFF;">    disp('Starting computation of figure-ground segmentations'); </span><br/><span style="color: #FF0000"> 96.20 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 117</span> <a name="Line117"></a><span style="color: #000000; background: #FF8080;">    masks = <a href="file49.html">cpmc_masks</a>(exp_dir, img_name, segm_pars); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF;">    time_segm = toc(t); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('Time computing figure-ground segmentations: %f\n', time_segm); </span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%% 2. compute segment ranking features %%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;">    % load ranker model (trained on training set of voc segmentation dataset)   </span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">    % substitute train by trainval for images outside the segmentation validation set</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;">    % of VOC2010.</span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 128</span> <span style="color: #000000; background: #FFFFFF;">    load([exp_dir '/MySegmentRankers/' ranker_file]); </span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF;">    t = tic(); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 131</span> <span style="color: #000000; background: #FFFFFF;">    disp('Starting feature extraction.'); </span><br/><span style="color: #FF0000"> 25.82 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 132</span> <a name="Line132"></a><span style="color: #000000; background: #FFE2E2;">    D = <a href="file170.html">get_features</a>(exp_dir, img_name, segm_pars.name, masks, segment_measurements); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 133</span> <span style="color: #000000; background: #FFFFFF;">    t_feats = toc(t); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 134</span> <span style="color: #000000; background: #FFFFFF;">    fprintf('Time getting all features: %f\n', t_feats);     </span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%% 3. rank masks %%%%%%%%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #228B22; background: #FFFFFF;">    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%     </span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #228B22; background: #FFFFFF;">    % normalize the features</span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">    D = cellfun(@double, D, 'UniformOutput', false); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">    D = D(:); </span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/><a name="Line144"></a>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 144</span> <span style="color: #000000; background: #FFFFFF;">    if(iscell(scaling)) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 145</span> <span style="color: #000000; background: #FFFFFF;">        for i=1:numel(scaling) </span><br/><span style="color: #FF0000">  0.14 </span><span style="color: #0000FF">      6 </span><span style="color: #000000; font-weight: bold"> 146</span> <span style="color: #000000; background: #FFFFFF;">            D{i} =  <a href="file298.html">scale_data</a>(D{i}, scaling_type, scaling{i}); </span><br/>       <span style="color: #0000FF">      6 </span><span style="color: #000000; font-weight: bold"> 147</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 148</span> <span style="color: #000000; background: #FFFFFF;">        D_scaled = <a href="file198.html">cell2mat</a>(D); </span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D_scaled = cell2mat(D);</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #A0A0A0; background: #FFFFFF;">        D_scaled = scale_data(D_scaled, scaling_type, scaling);</span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 154</span> <span style="color: #000000; background: #FFFFFF;">    dims = cellfun(@(a) size(a,1), D); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 155</span> <span style="color: #000000; background: #FFFFFF;">    Feats = D_scaled; </span><br/><span style="color: #FF0000">  1.81 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 156</span> <a name="Line156"></a><span style="color: #000000; background: #FFFFFF;">    [Feats] = <a href="file52.html">SvmSegm_mix_linear_and_random_features</a>(Feats, w.kernels, scaling_type, w.scaling_RF, dims, [], w.N_OUT_DIMS, w.obj, w.merge_kernels); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFFFFF;">    pred = <a href="file301.html">predict_regressor</a>(Feats, w.weights); </span><br/>               <span style="color: #A0A0A0"> 158</span> <span style="color: #228B22; background: #FFFFFF;">   </span><br/><span style="color: #FF0000">  1.10 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 159</span> <a name="Line159"></a><span style="color: #000000; background: #FFFFFF;">    small_masks = <a href="file100.html">imresize</a>(masks, 0.25, 'nearest'); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 160</span> <span style="color: #000000; background: #FFFFFF;">    small_masks = reshape(small_masks, size(small_masks,1) * size(small_masks,2), size(small_masks,3)); </span><br/><span style="color: #FF0000"> 14.30 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 161</span> <a name="Line161"></a><span style="color: #000000; background: #FFF0F0;">    overlap_mat = single(<a href="file266.html">segm_overlap_mex</a>(small_masks)); </span><br/><span style="color: #FF0000">  0.51 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 162</span> <span style="color: #000000; background: #FFFFFF;">    scores = <a href="file302.html">diversify_ranking</a>(pred, overlap_mat, diversify_const);    </span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">    [sorted_scores, ids] = sort(scores, 'descend'); </span><br/><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 165</span> <span style="color: #000000; background: #FFFFFF;">    masks = masks(:,:,ids); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 166</span> <span style="color: #000000; background: #FFFFFF;">    scores = sorted_scores; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 167</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>